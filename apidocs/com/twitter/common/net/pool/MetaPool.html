<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_24) on Tue May 03 22:03:44 MDT 2011 -->
<TITLE>
MetaPool
</TITLE>

<META NAME="date" CONTENT="2011-05-03">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MetaPool";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<script type="text/javascript">top.updateArtifact(window.location);</script><HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/MetaPool.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/twitter/common/net/pool/DynamicPool.html" title="class in com.twitter.common.net.pool"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/twitter/common/net/pool/MetaPool.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MetaPool.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.twitter.common.net.pool</FONT>
<BR>
Class MetaPool&lt;T,E&gt;</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>com.twitter.common.net.pool.MetaPool&lt;T,E&gt;</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;T,E&gt;&gt;</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.58"><B>MetaPool&lt;T,E&gt;</B></A><DT>extends java.lang.Object<DT>implements <A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;T,E&gt;&gt;</DL>
</PRE>

<P>
A connection pool that picks connections from a set of backend pools.  Backend pools are selected
 from randomly initially but then as they are used they are ranked according to how many
 connections they have available and whether or not the last used connection had an error or not.
 In this way, backends that are responsive should get selected in preference to those that are
 not.

 <p>Non-responsive backends are monitored after a configurable period in a background thread and
 if a connection can be obtained they start to float back up in the rankings.  In this way,
 backends that are initially non-responsive but later become responsive should end up getting
 selected.

 <p> TODO(John Sirois): take a ShutdownRegistry and register a close command
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_com.twitter.common.net.pool.ObjectPool"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from interface com.twitter.common.net.pool.<A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#NO_TIMEOUT">NO_TIMEOUT</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#MetaPool(com.google.common.collect.ImmutableMap, com.twitter.common.net.loadbalancing.LoadBalancer, com.twitter.common.base.Closure, com.twitter.common.quantity.Amount)">MetaPool</A></B>(com.google.common.collect.ImmutableMap&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>,<A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&gt;&nbsp;backends,
                 <A HREF="../../../../../com/twitter/common/net/loadbalancing/LoadBalancer.html" title="interface in com.twitter.common.net.loadbalancing">LoadBalancer</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;loadBalancer,
                 <A HREF="../../../../../com/twitter/common/base/Closure.html" title="interface in com.twitter.common.base">Closure</A>&lt;java.util.Collection&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&nbsp;onBackendsChosen,
                 <A HREF="../../../../../com/twitter/common/quantity/Amount.html" title="class in com.twitter.common.quantity">Amount</A>&lt;java.lang.Long,<A HREF="../../../../../com/twitter/common/quantity/Time.html" title="enum in com.twitter.common.quantity">Time</A>&gt;&nbsp;restoreInterval)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a connection pool that balances connections across multiple backend pools.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#MetaPool(com.twitter.common.net.loadbalancing.LoadBalancer, com.twitter.common.base.Closure, com.twitter.common.quantity.Amount)">MetaPool</A></B>(<A HREF="../../../../../com/twitter/common/net/loadbalancing/LoadBalancer.html" title="interface in com.twitter.common.net.loadbalancing">LoadBalancer</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;loadBalancer,
                 <A HREF="../../../../../com/twitter/common/base/Closure.html" title="interface in com.twitter.common.base">Closure</A>&lt;java.util.Collection&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&nbsp;onBackendsChosen,
                 <A HREF="../../../../../com/twitter/common/quantity/Amount.html" title="class in com.twitter.common.quantity">Amount</A>&lt;java.lang.Long,<A HREF="../../../../../com/twitter/common/quantity/Time.html" title="enum in com.twitter.common.quantity">Time</A>&gt;&nbsp;restoreInterval)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a connection pool with no backends.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#close()">close</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Disallows further gets from this pool, "closes" all idle objects and any outstanding objects
 when they are released.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#get()">get</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets a resource potentially blocking for as long as it takes to either create a new one or wait
 for one to be <A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)"><CODE>released</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#get(com.twitter.common.quantity.Amount)">get</A></B>(<A HREF="../../../../../com/twitter/common/quantity/Amount.html" title="class in com.twitter.common.quantity">Amount</A>&lt;java.lang.Long,<A HREF="../../../../../com/twitter/common/quantity/Time.html" title="enum in com.twitter.common.quantity">Time</A>&gt;&nbsp;timeout)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets a resource; timing out if there are none available and it takes longer than specified to
 create a new one or wait for one to be <A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)"><CODE>released</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#release(com.twitter.common.net.pool.Connection)">release</A></B>(<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Releases a resource obtained from this pool back into the pool of available resources.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#remove(com.twitter.common.net.pool.Connection)">remove</A></B>(<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalent to releasing a Connection with isValid() == false.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#setBackends(java.util.Map)">setBackends</A></B>(java.util.Map&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>,<A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&gt;&nbsp;pools)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assigns the backend pools that this pool should draw from.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html#stop()">stop</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stops dead backend restoration attempts.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="MetaPool(com.twitter.common.net.loadbalancing.LoadBalancer, com.twitter.common.base.Closure, com.twitter.common.quantity.Amount)"><!-- --></A><H3>
MetaPool</H3>
<PRE>
public <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.76"><B>MetaPool</B></A>(<A HREF="../../../../../com/twitter/common/net/loadbalancing/LoadBalancer.html" title="interface in com.twitter.common.net.loadbalancing">LoadBalancer</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;loadBalancer,
                <A HREF="../../../../../com/twitter/common/base/Closure.html" title="interface in com.twitter.common.base">Closure</A>&lt;java.util.Collection&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&nbsp;onBackendsChosen,
                <A HREF="../../../../../com/twitter/common/quantity/Amount.html" title="class in com.twitter.common.quantity">Amount</A>&lt;java.lang.Long,<A HREF="../../../../../com/twitter/common/quantity/Time.html" title="enum in com.twitter.common.quantity">Time</A>&gt;&nbsp;restoreInterval)</PRE>
<DL>
<DD>Creates a connection pool with no backends.  Backends may be added post-creation by calling
 <CODE>#setBackends<ImmutableSet>()</CODE>;
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>loadBalancer</CODE> - the load balancer to distribute requests among backends.<DD><CODE>onBackendsChosen</CODE> - a callback to notify whenever the <code>loadBalancer</code> chooses a new
     set of backends to restrict its call distribution to<DD><CODE>restoreInterval</CODE> - the interval after a backend goes dead to begin checking the backend to
     see if it has come back to a healthy state</DL>
</DL>
<HR>

<A NAME="MetaPool(com.google.common.collect.ImmutableMap, com.twitter.common.net.loadbalancing.LoadBalancer, com.twitter.common.base.Closure, com.twitter.common.quantity.Amount)"><!-- --></A><H3>
MetaPool</H3>
<PRE>
public <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.92"><B>MetaPool</B></A>(com.google.common.collect.ImmutableMap&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>,<A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&gt;&nbsp;backends,
                <A HREF="../../../../../com/twitter/common/net/loadbalancing/LoadBalancer.html" title="interface in com.twitter.common.net.loadbalancing">LoadBalancer</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;loadBalancer,
                <A HREF="../../../../../com/twitter/common/base/Closure.html" title="interface in com.twitter.common.base">Closure</A>&lt;java.util.Collection&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&nbsp;onBackendsChosen,
                <A HREF="../../../../../com/twitter/common/quantity/Amount.html" title="class in com.twitter.common.quantity">Amount</A>&lt;java.lang.Long,<A HREF="../../../../../com/twitter/common/quantity/Time.html" title="enum in com.twitter.common.quantity">Time</A>&gt;&nbsp;restoreInterval)</PRE>
<DL>
<DD>Creates a connection pool that balances connections across multiple backend pools.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>backends</CODE> - the connection pools for the backends<DD><CODE>onBackendsChosen</CODE> - a callback to notify whenever the <code>loadBalancer</code> chooses a new
     set of backends to restrict its call distribution to<DD><CODE>loadBalancer</CODE> - the load balancer to distribute requests among backends.<DD><CODE>restoreInterval</CODE> - the interval after a backend goes dead to begin checking the backend to
     see if it has come back to a healthy state</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setBackends(java.util.Map)"><!-- --></A><H3>
setBackends</H3>
<PRE>
public void <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.111"><B>setBackends</B></A>(java.util.Map&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>,<A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;&gt;&nbsp;pools)</PRE>
<DL>
<DD>Assigns the backend pools that this pool should draw from.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pools</CODE> - New pools to use.</DL>
</DD>
</DL>
<HR>

<A NAME="get()"><!-- --></A><H3>
get</H3>
<PRE>
public <A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt; <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.160"><B>get</B></A>()
                    throws <A HREF="../../../../../com/twitter/common/net/pool/ResourceExhaustedException.html" title="class in com.twitter.common.net.pool">ResourceExhaustedException</A>,
                           java.util.concurrent.TimeoutException</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#get()">ObjectPool</A></CODE></B></DD>
<DD>Gets a resource potentially blocking for as long as it takes to either create a new one or wait
 for one to be <A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)"><CODE>released</CODE></A>.  Callers must <A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)"><CODE>release</CODE></A>
 the connection when they are done with it.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#get()">get</A></CODE> in interface <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>a resource for exclusive use by the caller
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ResourceExhaustedException.html" title="class in com.twitter.common.net.pool">ResourceExhaustedException</A></CODE> - if no resource could be obtained because this pool was
     exhausted
<DD><CODE>java.util.concurrent.TimeoutException</CODE> - if we timed out while trying to fetch a resource</DL>
</DD>
</DL>
<HR>

<A NAME="get(com.twitter.common.quantity.Amount)"><!-- --></A><H3>
get</H3>
<PRE>
public <A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt; <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.165"><B>get</B></A>(<A HREF="../../../../../com/twitter/common/quantity/Amount.html" title="class in com.twitter.common.quantity">Amount</A>&lt;java.lang.Long,<A HREF="../../../../../com/twitter/common/quantity/Time.html" title="enum in com.twitter.common.quantity">Time</A>&gt;&nbsp;timeout)
                    throws <A HREF="../../../../../com/twitter/common/net/pool/ResourceExhaustedException.html" title="class in com.twitter.common.net.pool">ResourceExhaustedException</A>,
                           java.util.concurrent.TimeoutException</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#get(com.twitter.common.quantity.Amount)">ObjectPool</A></CODE></B></DD>
<DD>Gets a resource; timing out if there are none available and it takes longer than specified to
 create a new one or wait for one to be <A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)"><CODE>released</CODE></A>.  Callers must
 <A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)"><CODE>(Object) release</CODE></A> the connection when they are done with it.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#get(com.twitter.common.quantity.Amount)">get</A></CODE> in interface <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>timeout</CODE> - the maximum amount of time to wait
<DT><B>Returns:</B><DD>a resource for exclusive use by the caller
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ResourceExhaustedException.html" title="class in com.twitter.common.net.pool">ResourceExhaustedException</A></CODE> - if no resource could be obtained because this pool was
     exhausted
<DD><CODE>java.util.concurrent.TimeoutException</CODE> - if the specified timeout was reached before a resource became
     available</DL>
</DD>
</DL>
<HR>

<A NAME="release(com.twitter.common.net.pool.Connection)"><!-- --></A><H3>
release</H3>
<PRE>
public void <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.250"><B>release</B></A>(<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;connection)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)">ObjectPool</A></CODE></B></DD>
<DD>Releases a resource obtained from this pool back into the pool of available resources. It is an
 error to release a resource not obtained from this pool.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#release(T)">release</A></CODE> in interface <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>connection</CODE> - Resource to release.</DL>
</DD>
</DL>
<HR>

<A NAME="remove(com.twitter.common.net.pool.Connection)"><!-- --></A><H3>
remove</H3>
<PRE>
public void <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.259"><B>remove</B></A>(<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&nbsp;connection)</PRE>
<DL>
<DD>Equivalent to releasing a Connection with isValid() == false.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#remove(T)">remove</A></CODE> in interface <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>connection</CODE> - Resource to remove.<DT><B>See Also:</B><DD><CODE>ObjectPool#remove(Object)}</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="close()"><!-- --></A><H3>
close</H3>
<PRE>
public void <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.280"><B>close</B></A>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#close()">ObjectPool</A></CODE></B></DD>
<DD>Disallows further gets from this pool, "closes" all idle objects and any outstanding objects
 when they are released.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html#close()">close</A></CODE> in interface <CODE><A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool">ObjectPool</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/Connection.html" title="interface in com.twitter.common.net.pool">Connection</A>&lt;<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">T</A>,<A HREF="../../../../../com/twitter/common/net/pool/MetaPool.html" title="type parameter in MetaPool">E</A>&gt;&gt;</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="stop()"><!-- --></A><H3>
stop</H3>
<PRE>
protected final void <A HREF="../../../../../src-html/com/twitter/common/net/pool/MetaPool.html#line.301"><B>stop</B></A>()</PRE>
<DL>
<DD>Stops dead backend restoration attempts.

 <p>TODO(John Sirois): stop functionality is needed to properly implement a close that frees all
 pool resources; however having to expose it for subclasses is a hack that solely supports
 ServerSetConnectionPool - this might be made cleaner by injecting the dead pool restorer
 instead.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/MetaPool.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/twitter/common/net/pool/DynamicPool.html" title="class in com.twitter.common.net.pool"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/twitter/common/net/pool/ObjectPool.html" title="interface in com.twitter.common.net.pool"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/twitter/common/net/pool/MetaPool.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MetaPool.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
